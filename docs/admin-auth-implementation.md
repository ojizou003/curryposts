# 管理者画面パスワード認証実装計画

## 概要
現在の管理者画面はURL直アクセスで誰でも利用可能な状態です。セキュリティ向上のため、簡易的なパスワード認証機能を追加します。

## 現状の課題
- 管理者ページ（/admin）に認証機能がない
- 誰でも投稿の追加・編集・削除が可能
- 意図しない操作や不正アクセスのリスク

## 実装方針
**クライアント側での簡易認証方式**を採用：
- 複雑なサーバーサイド認証は実装しない（要件に合わせて簡易的に）
- セッションストレージで認証状態を管理
- 固定パスワードによる認証

## 具体的な実装計画

### 1. 認証関連コンポーネント作成

#### 1.1 AdminAuthコンポーネント
- `src/components/AdminAuth.tsx`として作成
- パスワード入力フォーム
- 認証エラー表示
- ローディング状態表示

#### 1.2 認証管理フック
- `src/hooks/useAdminAuth.ts`として作成
- 認証状態の管理
- セッションストレージへの保存・読み込み
- セッション有効期限チェック

### 2. 管理者ページの変更

#### 2.1 認証ゲートの追加
- `/src/app/admin/page.tsx`を変更
- 未認証時：パスワード入力画面
- 認証済み：既存の管理画面

#### 2.2 ログアウト機能
- 管理画面にログアウトボタンを追加
- セッションストレージのクリア

### 3. 認証ロジックの詳細

#### 3.1 パスワード設定
- 環境変数 `NEXT_PUBLIC_ADMIN_PASSWORD` で設定
- クライアント側でアクセス可能な変数名を使用

#### 3.2 セッション管理
- 認証成功時にセッションストレージに保存
- 有効期限：1時間
- ページ再読み込み時に認証状態を確認

#### 3.3 セキュリティ考慮
- パスワードのハッシュ化（クライアント側）
- 簡易的なXSS対策
- 認証失敗時のエラーメッセージ

### 4. UI/UX設計

#### 4.1 ログイン画面
- シンプルなパスワード入力フォーム
- カレーテーマに合わせたデザイン
- レスポンシブ対応

#### 4.2 エラー表示
- パスワード不一致時のエラーメッセージ
- フォームバリデーションエラー
- セッション切れの表示

#### 4.3 管理画面
- ログアウトボタンの配置
- 認証状態の表示（オプション）

## 実装ファイル構成
```
src/
├── components/
│   └── AdminAuth.tsx          [新規]
├── hooks/
│   └── useAdminAuth.ts         [新規]
└── app/
    └── admin/
        └── page.tsx            [変更]
```

## 技術仕様

### 1. データ構造
```typescript
interface AuthState {
  isAuthenticated: boolean;
  loginTime: number;
  expiresAt: number;
}

const ADMIN_PASSWORD = 'curry2025'; // 固定パスワード
const SESSION_DURATION = 60 * 60 * 1000; // 1時間（ミリ秒）
```

### 2. 主要機能
- パスワード認証
- セッション管理
- 自動ログアウト
- エラーハンドリング

### 3. セキュリティ対策
- パスワードのクライアント側ハッシュ化
- セッション期限の設定
- 簡易的な入力値のバリデーション

## 実装手順

1. **認証フックの作成**
   - `useAdminAuth.ts`の実装
   - セッション管理ロジック

2. **認証コンポーネントの作成**
   - `AdminAuth.tsx`の実装
   - UIコンポーネントの作成

3. **管理者ページの変更**
   - 認証ゲートの追加
   - ログアウト機能の実装

4. **テスト**
   - 認証機能のテスト
   - セッション管理のテスト
   - UIのテスト

## 期待される効果
- 不正アクセスの簡易的な防止
- 管理者ページのセキュリティレベル向上
- 運用上の安心感向上
- 将来的な本格的認証システムへの移行準備

## 今後の拡張可能性
- 環境変数でのパスワード設定
- ユーザー管理機能の追加
- サーバーサイド認証への移行
- 多要素認証の導入

## 注意事項
- あくまで簡易的な認証機能として実装
- 本格的なセキュリティが必要な場合は別途検討
- パスワードは定期的に変更を推奨
- ブラウザの開発者ツールで回避可能である点を理解